apiVersion: flux-framework.org/v1alpha2
kind: MiniCluster
metadata:
  name: osu

spec:
  # The number of pods (and therefore nodes) for this job.
  interactive: true
  size: 32
  tasks: 1536
  logging:
    quiet: false

  flux:
    optionFlags: "-o cpu-affinity=per-task"
    container:
      disable: true

  containers:
    - image: ghcr.io/converged-computing/google-performance-study:osu-caliper-test
      imagePullPolicy: Always
      volumes:
        my-empty-dir:
          emptyDir: true
          emptyDirMedium: "memory"              
      command: /bin/bash /entrypoint.sh
      launcher: true
      resources:
        limits:
          cpu: "46"
        requests:
          cpu: "46"
         
